{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/home/matheus/Documents/drive-sync/Projects/endor/packages/web/src/components/Modals/CreateFuneralsModal/index.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useCallback, useRef, useEffect, useState } from 'react';\nimport { Button, Flex, Modal, ModalBody, ModalCloseButton, ModalContent, ModalFooter, ModalHeader, ModalOverlay, useToast } from '@chakra-ui/core';\nimport { Form } from '@unform/web';\nimport * as Yup from 'yup';\nimport Input from '@/components/Input';\nimport Select from '@/components/Select';\nimport getValidationErrors from '@/utils/getValidationErrors';\nimport api from '../../../services/api';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nvar CreateFuneralsModal = function CreateFuneralsModal(_ref) {\n  _s();\n\n  var isOpen = _ref.isOpen,\n      onClose = _ref.onClose,\n      onSave = _ref.onSave;\n  var formRef = useRef(null);\n\n  var _useState = useState([]),\n      cemeteries = _useState[0],\n      setCemeteries = _useState[1];\n\n  var toast = useToast();\n  useEffect(function () {\n    api.get('cemeteries').then(function (response) {\n      var cemeteriesResponse = response.data;\n      setCemeteries(cemeteriesResponse);\n    });\n  }, []);\n  var handleSubmit = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data, event) {\n      var _formRef$current, schema, _formRef$current2, errors;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setErrors({});\n              schema = Yup.object().shape({\n                name: Yup.string().required('Nome obrigatório'),\n                url_cam: Yup.string().required('Link da camêra obrigatório'),\n                cemetery_id: Yup.string().uuid().required('Cemitério obrigatório')\n              });\n              _context.next = 5;\n              return schema.validate(data, {\n                abortEarly: false\n              });\n\n            case 5:\n              _context.next = 7;\n              return api.post('funerals', data);\n\n            case 7:\n              toast({\n                status: 'success',\n                title: 'Velório criado com sucesso',\n                position: 'top',\n                duration: 3000\n              });\n              onClose(event);\n              onSave();\n              _context.next = 19;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n\n              if (!(_context.t0 instanceof Yup.ValidationError)) {\n                _context.next = 18;\n                break;\n              }\n\n              errors = getValidationErrors(_context.t0);\n              (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.setErrors(errors);\n              return _context.abrupt(\"return\");\n\n            case 18:\n              toast({\n                status: 'error',\n                title: 'Erro ao registrar cemitério',\n                description: 'Ocorreu um erro ao registrar cemitério, tente novamente.',\n                position: 'top',\n                duration: 5000\n              });\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 12]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), []);\n  return ___EmotionJSX(Modal, {\n    isOpen: isOpen,\n    onClose: onClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 5\n    }\n  }, ___EmotionJSX(ModalOverlay, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }\n  }), ___EmotionJSX(ModalContent, {\n    maxWidth: 900,\n    borderRadius: \"md\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, ___EmotionJSX(ModalHeader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, \"Registrar vel\\xF3rio\"), ___EmotionJSX(ModalCloseButton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }), ___EmotionJSX(Form, {\n    ref: formRef,\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, ___EmotionJSX(ModalBody, {\n    paddingBottom: 4,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, ___EmotionJSX(Flex, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, ___EmotionJSX(Input, {\n    name: \"name\",\n    placeholder: \"Nome\",\n    containerProps: {\n      border: '1px solid',\n      borderColor: 'gray.400',\n      bg: 'white'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 15\n    }\n  }), ___EmotionJSX(Input, {\n    name: \"url_cam\",\n    placeholder: \"Link da cam\\xEAra do vel\\xF3rio\",\n    containerProps: {\n      marginLeft: '16px',\n      border: '1px solid',\n      borderColor: 'gray.400',\n      bg: 'white'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 15\n    }\n  }), ___EmotionJSX(Select, {\n    name: \"cemetery_id\",\n    placeholder: \"Selecione o cemit\\xE9rio\",\n    containerProps: {\n      marginLeft: '16px',\n      border: '1px solid',\n      borderColor: 'gray.400',\n      bg: 'white'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  }, cemeteries.map(function (cemetery) {\n    return ___EmotionJSX(\"option\", {\n      value: cemetery.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 19\n      }\n    }, cemetery.name);\n  })))), ___EmotionJSX(ModalFooter, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, ___EmotionJSX(Button, {\n    variant: \"ghost\",\n    onClick: onClose,\n    marginRight: 4,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, \"Cancelar\"), ___EmotionJSX(Button, {\n    type: \"submit\",\n    variantColor: \"green\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, \"Salvar\")))));\n};\n\n_s(CreateFuneralsModal, \"JEE6vDbXIyJBJ/E/n2l8q2hPxwA=\", false, function () {\n  return [useToast];\n});\n\n_c = CreateFuneralsModal;\nexport default CreateFuneralsModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateFuneralsModal\");","map":{"version":3,"sources":["/home/matheus/Documents/drive-sync/Projects/endor/packages/web/src/components/Modals/CreateFuneralsModal/index.tsx"],"names":["React","useCallback","useRef","useEffect","useState","Button","Flex","Modal","ModalBody","ModalCloseButton","ModalContent","ModalFooter","ModalHeader","ModalOverlay","useToast","Form","Yup","Input","Select","getValidationErrors","api","CreateFuneralsModal","isOpen","onClose","onSave","formRef","cemeteries","setCemeteries","toast","get","then","response","cemeteriesResponse","data","handleSubmit","event","current","setErrors","schema","object","shape","name","string","required","url_cam","cemetery_id","uuid","validate","abortEarly","post","status","title","position","duration","ValidationError","errors","description","border","borderColor","bg","marginLeft","map","cemetery","id"],"mappings":"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","sourcesContent":["import React, { useCallback, useRef, useEffect, useState } from 'react';\n\nimport {\n  Button,\n  Flex,\n  Modal,\n  ModalBody,\n  ModalCloseButton,\n  ModalContent,\n  ModalFooter,\n  ModalHeader,\n  ModalOverlay,\n  useToast,\n} from '@chakra-ui/core';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport * as Yup from 'yup';\n\nimport Input from '@/components/Input';\nimport Select from '@/components/Select';\nimport getValidationErrors from '@/utils/getValidationErrors';\n\nimport api from '../../../services/api';\n\ninterface IFormData {\n  name: string;\n  email: string;\n  telephone: string;\n  gender: string;\n  cpf: string;\n  birth_date: Date;\n}\n\ninterface ICemeteries {\n  id: string;\n  name: string;\n}\n\ninterface ICreateFuneralsModalProps {\n  isOpen: boolean;\n  onClose?: (\n    event: React.MouseEvent | React.KeyboardEvent,\n    reason?: 'pressedEscape' | 'clickedOverlay',\n  ) => void;\n  onSave: () => void;\n}\nconst CreateFuneralsModal: React.FC<ICreateFuneralsModalProps> = ({\n  isOpen,\n  onClose,\n  onSave,\n}) => {\n  const formRef = useRef<FormHandles>(null);\n\n  const [cemeteries, setCemeteries] = useState<ICemeteries[]>(\n    [] as ICemeteries[],\n  );\n  const toast = useToast();\n\n  useEffect(() => {\n    api.get('cemeteries').then(response => {\n      const cemeteriesResponse: ICemeteries[] = response.data;\n\n      setCemeteries(cemeteriesResponse);\n    });\n  }, []);\n  const handleSubmit = useCallback(async (data: IFormData, event) => {\n    try {\n      formRef.current?.setErrors({});\n\n      const schema = Yup.object().shape({\n        name: Yup.string().required('Nome obrigatório'),\n        url_cam: Yup.string().required('Link da camêra obrigatório'),\n        cemetery_id: Yup.string().uuid().required('Cemitério obrigatório'),\n      });\n\n      await schema.validate(data, { abortEarly: false });\n\n      await api.post('funerals', data);\n\n      toast({\n        status: 'success',\n        title: 'Velório criado com sucesso',\n        position: 'top',\n        duration: 3000,\n      });\n\n      onClose(event);\n      onSave();\n    } catch (err) {\n      if (err instanceof Yup.ValidationError) {\n        const errors = getValidationErrors(err);\n\n        formRef.current?.setErrors(errors);\n\n        return;\n      }\n\n      toast({\n        status: 'error',\n        title: 'Erro ao registrar cemitério',\n        description: 'Ocorreu um erro ao registrar cemitério, tente novamente.',\n        position: 'top',\n        duration: 5000,\n      });\n    }\n  }, []);\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose}>\n      <ModalOverlay />\n\n      <ModalContent maxWidth={900} borderRadius=\"md\">\n        <ModalHeader>Registrar velório</ModalHeader>\n        <ModalCloseButton />\n\n        <Form ref={formRef} onSubmit={handleSubmit}>\n          <ModalBody paddingBottom={4}>\n            <Flex>\n              <Input\n                name=\"name\"\n                placeholder=\"Nome\"\n                containerProps={{\n                  border: '1px solid',\n                  borderColor: 'gray.400',\n                  bg: 'white',\n                }}\n              />\n              <Input\n                name=\"url_cam\"\n                placeholder=\"Link da camêra do velório\"\n                containerProps={{\n                  marginLeft: '16px',\n                  border: '1px solid',\n                  borderColor: 'gray.400',\n                  bg: 'white',\n                }}\n              />\n              <Select\n                name=\"cemetery_id\"\n                placeholder=\"Selecione o cemitério\"\n                containerProps={{\n                  marginLeft: '16px',\n                  border: '1px solid',\n                  borderColor: 'gray.400',\n                  bg: 'white',\n                }}\n              >\n                {cemeteries.map(cemetery => (\n                  <option value={cemetery.id}>{cemetery.name}</option>\n                ))}\n              </Select>\n            </Flex>\n          </ModalBody>\n\n          <ModalFooter>\n            <Button variant=\"ghost\" onClick={onClose} marginRight={4}>\n              Cancelar\n            </Button>\n\n            <Button type=\"submit\" variantColor=\"green\">\n              Salvar\n            </Button>\n          </ModalFooter>\n        </Form>\n      </ModalContent>\n    </Modal>\n  );\n};\n\nexport default CreateFuneralsModal;\n"]},"metadata":{},"sourceType":"module"}