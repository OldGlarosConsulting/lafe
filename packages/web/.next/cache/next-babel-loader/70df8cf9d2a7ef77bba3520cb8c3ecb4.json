{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/home/matheus/Documents/drive-sync/Projects/lafe/packages/web/src/pages/dashboard.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport NextLink from 'next/link';\nimport { useRouter } from 'next/router';\nimport React, { useCallback, useRef } from 'react';\nimport { FiLock, FiMail } from 'react-icons/fi';\nimport { useToast, Button, Flex, Heading, Link } from '@chakra-ui/core';\nimport { Form } from '@unform/web';\nimport * as Yup from 'yup';\nimport Input from '@/components/Input';\nimport SEO from '@/components/SEO';\nimport { useAuthentication } from '@/hooks/authentication';\nimport getValidationErrors from '@/utils/getValidationErrors';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nvar Login = function Login() {\n  _s();\n\n  var formRef = useRef(null);\n  var router = useRouter();\n  var toast = useToast();\n\n  var _useAuthentication = useAuthentication(),\n      logIn = _useAuthentication.logIn;\n\n  var handleSubmit = useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var _formRef$current, schema, _formRef$current2, errors;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setErrors({});\n              schema = Yup.object().shape({\n                email: Yup.string().email().required('E-mail obrigatório'),\n                password: Yup.string().required('Senha obrigatória')\n              });\n              _context.next = 5;\n              return schema.validate(data, {\n                abortEarly: false\n              });\n\n            case 5:\n              _context.next = 7;\n              return logIn(data);\n\n            case 7:\n              toast({\n                status: 'success',\n                title: 'Autenticado com sucesso',\n                description: 'Você está sendo redirecionado para a página inicial.',\n                position: 'top',\n                duration: 3000\n              });\n              router.replace('/register/cemeteries');\n              _context.next = 18;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](0);\n\n              if (!(_context.t0 instanceof Yup.ValidationError)) {\n                _context.next = 17;\n                break;\n              }\n\n              errors = getValidationErrors(_context.t0);\n              (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.setErrors(errors);\n              return _context.abrupt(\"return\");\n\n            case 17:\n              toast({\n                status: 'error',\n                title: 'Erro na autenticação',\n                description: 'Ocorreu um erro ao fazer login, cheque as credenciais.',\n                position: 'top',\n                duration: 5000\n              });\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 11]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }(), []);\n  return ___EmotionJSX(React.Fragment, null, ___EmotionJSX(SEO, {\n    title: \"Lafe\",\n    image: \"og/boost.png\",\n    shouldExcludeTitleSuffix: true,\n    description: \"Fazer login na plataforma\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }), ___EmotionJSX(Flex, {\n    as: \"main\",\n    height: \"100vh\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingX: 6,\n    backgroundColor: \"gray.900\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, ___EmotionJSX(Flex, {\n    backgroundColor: \"gray.800\",\n    borderRadius: \"md\",\n    flexDirection: \"column\",\n    alignItems: \"stretch\",\n    padding: 16,\n    boxShadow: \"xl\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, ___EmotionJSX(Form, {\n    ref: formRef,\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, ___EmotionJSX(Heading, {\n    color: \"gray.200\",\n    marginBottom: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }, \"Login\"), ___EmotionJSX(Input, {\n    name: \"email\",\n    icon: FiMail,\n    placeholder: \"E-mail\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }), ___EmotionJSX(Input, {\n    name: \"password\",\n    icon: FiLock,\n    type: \"password\",\n    placeholder: \"Senha\",\n    containerProps: {\n      marginTop: 3\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  }), ___EmotionJSX(Button, {\n    type: \"submit\",\n    bg: \"gray.400\",\n    color: \"gray.800\",\n    _hover: {\n      bg: 'gray.500',\n      color: 'gray.900'\n    },\n    _focusWithin: {\n      bg: 'gray.500',\n      color: 'gray.900'\n    },\n    width: \"100%\",\n    marginY: 4,\n    paddingY: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }, \"Entrar\"), ___EmotionJSX(NextLink, {\n    href: \"forgot-password\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, ___EmotionJSX(Link, {\n    color: \"gray.500\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }, \"Esqueci minha senha\"))))));\n};\n\n_s(Login, \"qLES2phVvZAo2YgL8uucvtuuJcs=\", false, function () {\n  return [useRouter, useToast, useAuthentication];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/matheus/Documents/drive-sync/Projects/lafe/packages/web/src/pages/dashboard.tsx"],"names":["NextLink","useRouter","React","useCallback","useRef","FiLock","FiMail","useToast","Button","Flex","Heading","Link","Form","Yup","Input","SEO","useAuthentication","getValidationErrors","Login","formRef","router","toast","logIn","handleSubmit","data","current","setErrors","schema","object","shape","email","string","required","password","validate","abortEarly","status","title","description","position","duration","replace","ValidationError","errors","marginTop","bg","color"],"mappings":"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","sourcesContent":["import NextLink from 'next/link';\nimport { useRouter } from 'next/router';\nimport React, { useCallback, useRef } from 'react';\nimport { FiLock, FiMail } from 'react-icons/fi';\n\nimport { useToast, Button, Flex, Heading, Link } from '@chakra-ui/core';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport * as Yup from 'yup';\n\nimport Input from '@/components/Input';\nimport SEO from '@/components/SEO';\nimport { useAuthentication } from '@/hooks/authentication';\nimport getValidationErrors from '@/utils/getValidationErrors';\n\ninterface IFormData {\n  email: string;\n  password: string;\n}\n\nconst Login: React.FC = () => {\n  const formRef = useRef<FormHandles>(null);\n\n  const router = useRouter();\n\n  const toast = useToast();\n\n  const { logIn } = useAuthentication();\n\n  const handleSubmit = useCallback(async (data: IFormData) => {\n    try {\n      formRef.current?.setErrors({});\n\n      const schema = Yup.object().shape({\n        email: Yup.string().email().required('E-mail obrigatório'),\n        password: Yup.string().required('Senha obrigatória'),\n      });\n\n      await schema.validate(data, { abortEarly: false });\n\n      await logIn(data);\n\n      toast({\n        status: 'success',\n        title: 'Autenticado com sucesso',\n        description: 'Você está sendo redirecionado para a página inicial.',\n        position: 'top',\n        duration: 3000,\n      });\n\n      router.replace('/register/cemeteries');\n    } catch (err) {\n      if (err instanceof Yup.ValidationError) {\n        const errors = getValidationErrors(err);\n\n        formRef.current?.setErrors(errors);\n\n        return;\n      }\n\n      toast({\n        status: 'error',\n        title: 'Erro na autenticação',\n        description: 'Ocorreu um erro ao fazer login, cheque as credenciais.',\n        position: 'top',\n        duration: 5000,\n      });\n    }\n  }, []);\n\n  return (\n    <>\n      <SEO\n        title=\"Lafe\"\n        image=\"og/boost.png\"\n        shouldExcludeTitleSuffix\n        description=\"Fazer login na plataforma\"\n      />\n\n      <Flex\n        as=\"main\"\n        height=\"100vh\"\n        justifyContent=\"center\"\n        alignItems=\"center\"\n        paddingX={6}\n        backgroundColor=\"gray.900\"\n      >\n        <Flex\n          backgroundColor=\"gray.800\"\n          borderRadius=\"md\"\n          flexDirection=\"column\"\n          alignItems=\"stretch\"\n          padding={16}\n          boxShadow=\"xl\"\n        >\n          <Form ref={formRef} onSubmit={handleSubmit}>\n            <Heading color=\"gray.200\" marginBottom={6}>\n              Login\n            </Heading>\n            <Input name=\"email\" icon={FiMail} placeholder=\"E-mail\" />\n            <Input\n              name=\"password\"\n              icon={FiLock}\n              type=\"password\"\n              placeholder=\"Senha\"\n              containerProps={{\n                marginTop: 3,\n              }}\n            />\n            <Button\n              type=\"submit\"\n              bg=\"gray.400\"\n              color=\"gray.800\"\n              _hover={{\n                bg: 'gray.500',\n                color: 'gray.900',\n              }}\n              _focusWithin={{\n                bg: 'gray.500',\n                color: 'gray.900',\n              }}\n              width=\"100%\"\n              marginY={4}\n              paddingY={6}\n            >\n              Entrar\n            </Button>\n            <NextLink href=\"forgot-password\">\n              <Link color=\"gray.500\">Esqueci minha senha</Link>\n            </NextLink>\n          </Form>\n        </Flex>\n      </Flex>\n    </>\n  );\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}